<ion-view view-title="Tim Bickmore">
  <ion-content>
    <div class="bar bar-header history-bar-header">
      <h1 class="title">My History</h1>
    </div>
    <!-- History List -->
    <ul class="list history-list">
      <li ng-repeat="history in histories" class="item">
        <a href="#/app/suggestions/{{history.suggestion.id}}" class="absolutely-full"></a>
        <div class="row">
          <div class="col col-67">
            <h3>{{history.suggestion.title}}</h3>
          </div>
          <div class="col">
            <!-- If no review, place a button for review -->
            <div ng-if="history.userRating" class="star-container history-star-container">
              <span ng-repeat="i in range(history.userRating) track by $index">
                <span class="icon ion-ios-star"></span>
              </span>
              <span ng-repeat="i in range(5 - history.userRating) track by $index">
                <span class="icon ion-ios-star-outline"></span>
              </span>
            </div>
            <button ng-if="!history.userRating"
                    ng-click="reviewSuggestion({{history.id}})"
                    class="button button-stable button-review">
              Review
            </button>
          </div>
        </div>
        <div class="row" ng-if="history.userReview">
          <div class="col">
            <p>{{history.userReview}}</p>
          </div>
        </div>
      </li>
    </ul>
  </ion-content>
  <!-- Review Popup -->
    <div class="review-popup" ng-if="showReviewPopup">
      <div class="review-popup" ng-click="closeReviewPopup()" style="z-index:0"></div>
      <div class="row first-row">
        <div class="col col-80 col-offset-10 review-body" ng-controller="ReviewCtrl">
          <h5 class="review-title">Review This Place</h5>
          <form novalidate class="list">
            <div class="list">
              <label class="item item-input">
                <span class="input-label">Star Rating</span>
                <input ng-model="newReview.rating" id="review-star-amt" type="number" value="0"></input>
                <div class="star-container">
                  <button id="star-1" class="button-clear icon ion-ios-star-outline" ng-click="setStar(1)"></button>
                  <button id="star-2" class="button-clear icon ion-ios-star-outline" ng-click="setStar(2)"></button>
                  <button id="star-3" class="button-clear icon ion-ios-star-outline" ng-click="setStar(3)"></button>
                  <button id="star-4" class="button-clear icon ion-ios-star-outline" ng-click="setStar(4)"></button>
                  <button id="star-5" class="button-clear icon ion-ios-star-outline" ng-click="setStar(5)"></button>
                </div>
              </label>
              <label class="item item-input item-stacked-label">
                <span class="input-label">Leave a text review (optional)</span>
                <textarea ng-model="newReview.review" placeholder="Loved this place!"></textarea>
              </label>
            </div>
            <input class="button button-block button-stable button-submit" type="submit" ng-click="submitReview(newReview)" value="Submit" />
          </form>
        </div>
      </div>
    </div>
</ion-view>
